function valuefunccalc(transmatrix, reward, gamma, statenum)
      return inv(eye(statenum) - gamma1*transmatrix)*reward
end

# Value Function Calculation for Grid Example

transmatrix1= [0 0.5 0 0 0 0.5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0;
              0 (1/3) 0 (1/3) 0 0 0 (1/3) 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0.5 0 0 0 0.5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              (1/3) 0 0 0 0 0 (1/3) 0 0 (1/3) 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0.25 0 0 0 0.25 0 0.25 0 0 0.25 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0.25 0 0 0 0.25 0 0.25 0 0 0.25 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0.25 0 0 0 0.25 0 0.25 0 0 0.25 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 (1/3) 0 0 0 (1/3) 0 0 0 0 0 (1/3) 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 (1/3) 0 0 0 0 0 0 (1/3) 0 0 0 (1/3) 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0.25 0 0 0 0.25 0 0.25 0 0 0.25 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0.25 0 0 0 0.25 0 0.25 0 0 0.25 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0.25 0 0 0 0.25 0 0.25 0 0 0.25 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 (1/3) 0 0 0 (1/3) 0 0 0 0 0 (1/3) 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 (1/3) 0 0 0 0 0 0 (1/3) 0 0 0 (1/3) 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0.25 0 0 0 0.25 0 0.25 0 0 0.25 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0.25 0 0 0 0.25 0 0.25 0 0 0.25 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0 0 0 0.25 0 0.25 0 0 0.25 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 (1/3) 0 0 0 (1/3) 0 0 0 0 0 (1/3);
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 0 0 0 0 0.5 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 (1/3) 0 0 0 (1/3) 0 (1/3) 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 (1/3) 0 0 0 (1/3) 0 (1/3) 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 (1/3) 0 0 0 (1/3) 0 (1/3);
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 0 0 0.5 0;]
reward1= [-1, 10, -1, 5, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1]
gamma1= 0.9
valuefunccalc(transmatrix1, reward1, gamma1, 25)

# Value Function Calculation for Maze Example

transmatrix2= [0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0.5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 0 0 0 0 0 0 0 0;
              0 0.5 0 0.5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0.5 0 0.5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0.5 0 0.5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 (1/3) 0 (1/3) (1/3) 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0.5 0 0 0.5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0.5 0 0.5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0.5 0 0.5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0.5 0 0.5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0.5 0 0.5 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0.5 0 0.5 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 0.5 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 0.5 0 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 0.5 0 0 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
              0 0.5 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 0.5 0 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 0.5 0 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 0.5 0 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 0.5 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 (1/3) 0 (1/3) (1/3) 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 0 0.5 0;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0 0.5;
              0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0;]

reward2= [-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1]
gamma2= 1
valuefunccalc(transmatrix2, reward2, gamma2, 27)

# Value Function Calculation for Student Example

transmatrix3= [0 0.5 0 0 0 0.5 0;
               0 0 0.8 0 0 0 0.2;
               0 0 0 0.6 0.4 0 0;
               0 0 0 0 0 0 1;
               0.2 0.4 0.4 0 0 0 0;
               0.1 0 0 0 0 0.9 0;
               0 0 0 0 0 0 1;]
reward3= [-2, -2, -2, 10, 1, -1, 0]
gamma3= 0.9
valuefunccalc(transmatrix3, reward3, gamma3, 7)
